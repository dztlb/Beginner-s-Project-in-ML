# 风电功率预测项目

## 项目简介

本项目实现了一种基于自适应沙丁鱼优化算法驱动的信号分解方法和基于注意力机制的混合深度学习模型，用于风电功率的精准预测。

## 项目特点

### 先进的数据处理方法
- **智能数据清洗**: 使用滑动窗口均值插补法处理缺失值
- **异常值检测**: 采用孤立森林算法进行异常检测
- **异常值修正**: 使用支持向量机对异常值进行智能修正
- **平稳性检验**: 使用KPSS检验功率数据的平稳性

### 创新的特征工程
- **时序特征**: 滞后特征、滚动统计特征
- **频域特征**: 连续小波变换(CWT)特征提取
- **智能选择**: 使用RFECV进行自动特征选择
- **相关性分析**: 皮尔逊相关系数分析特征关系

### 优化的信号分解
- **CEEMDAN分解**: 完全集合经验模态分解自适应噪声
- **样本熵分析**: 智能识别和合并低熵IMF
- **算法优化**: 自适应沙丁鱼算法优化分解过程

### 创新的深度学习架构
- **TCN替代CNN**: 时序卷积网络增强并行处理能力
- **多头注意力**: 高效的信息处理和长距离依赖捕捉
- **双向GRU**: 强化时间序列特征学习效果
- **混合架构**: 结合多种深度学习技术的优势

### 智能优化算法
- **自适应沙丁鱼群优化**: 用于超参数调优和信号分解优化
- **全局搜索**: 避免陷入局部最优解
- **收敛监控**: 可视化优化过程，实时监控收敛情况

## 技术架构

```
数据输入 → 数据预处理 → 特征工程 → 信号分解 → 深度学习模型 → 预测输出
    ↓           ↓          ↓         ↓         ↓
  原始数据   清洗+修正   多维度特征  CEEMDAN   TCN+注意力+BiGRU
```

## 主要功能

1. **数据质量提升**: 自动处理缺失值和异常值
2. **特征自动提取**: 智能生成时序和频域特征
3. **信号智能分解**: 优化CEEMDAN分解过程
4. **模型自动训练**: 支持多种深度学习架构
5. **性能全面评估**: 多种评估指标和可视化分析

## 环境要求

- Python 3.8+
- Anaconda 或 Miniconda
- PyCharm IDE (推荐)
- 8GB+ 内存
- GPU支持 (可选，用于加速训练)

## 快速开始

1. **克隆项目**
```bash
git clone [项目地址]
cd wind_power_prediction
```

2. **创建环境**
```bash
conda env create -f environment.yml
conda activate wind_power_prediction
```

3. **运行项目**
```bash
python run.py
```

## 项目结构

```
wind_power_prediction/
├── data/                     # 数据目录
│   └── 项目2-0.csv             # 风电数据集
├── src/                      # 源代码目录
│   ├── utils/               # 工具函数
│   │   ├── __init__.py
│   │   ├── data_processing.py  # 数据处理模块
│   │   ├── feature_engineering.py # 特征工程模块
│   │   ├── model_utils.py      # 模型工具模块
│   │   └── visualization.py    # 可视化模块
│   ├── models/              # 模型训练
│   │   ├── __init__.py
│   │   ├── deep_learning.py    # 深度学习模型
│   │   └── random_forest.py    # 随机森林模型
│   └── main.py                 # 主程序
├── tests/                   # 测试文件
│   ├── test_environment.py     # 环境测试脚本
│   ├── test_dependencies.py    # 依赖包检查脚本
│   ├── test_quick_mode.py      # 快速验证测试文件
│   └── run_training.py         # 训练运行脚本
├── results/                 # 结果输出目录
│   ├── plots/              # 图表文件
│   ├── logs/               # 日志文件
│   └── models/             # 保存的模型
├── docs/                    # 文档目录
│   └── 项目详细说明文档.md     # 完整项目文档
├── run.py                      # 项目运行入口
├── requirements.txt            # Python依赖包
├── environment.yml             # Conda环境配置
└── README.md                   # 项目说明
```

### 核心文件说明

#### **run.py** - 项目运行入口
**作用**: 项目的主要运行入口，调用各个模块完成完整的训练流程

#### **src/main.py** - 主程序文件
**作用**: 项目的核心主程序，实现完整的风电功率预测系统

**主要功能**:
- **数据预处理**: 滑动窗口均值插补、孤立森林异常检测、SVM异常值修正
- **特征工程**: 滞后特征、滚动统计、连续小波变换、RFECV特征选择
- **信号分解**: CEEMDAN分解，自适应沙丁鱼算法优化
- **深度学习**: TCN-多头注意力-BiGRU混合模型
- **传统机器学习**: 随机森林（自适应沙丁鱼群优化）
- **模型对比**: 深度学习vs传统机器学习的性能对比

**特色算法**:
- 自适应沙丁鱼群优化算法
- TCN-注意力机制-BiGRU混合深度学习模型
- CEEMDAN信号分解

#### **src/utils/** - 工具函数包
**作用**: 包含所有工具函数，按功能模块化组织

**主要模块**:
- **data_processing.py**: 数据处理、清洗、预处理
- **feature_engineering.py**: 特征创建、选择、变换
- **model_utils.py**: 模型构建工具、优化算法
- **visualization.py**: 图表绘制、结果展示

#### **src/models/** - 模型训练包
**作用**: 包含深度学习模型和传统机器学习模型的训练功能

**主要模块**:
- **deep_learning.py**: TCN-注意力-BiGRU模型训练
- **random_forest.py**: 随机森林模型训练（自适应沙丁鱼群优化）

#### **test_environment.py** - 环境配置验证文件
**作用**: 环境测试工具，用于验证开发环境是否正确配置

**主要功能**:
- 测试Python版本和路径
- 验证所有必要包的导入（pandas, numpy, matplotlib, seaborn, sklearn, tensorflow等）
- 测试数据处理功能
- 测试机器学习功能
- 测试深度学习功能
- 提供详细的测试结果报告

**使用场景**: 在运行主程序前，先运行此文件确保环境配置正确

#### **test_dependencies.py** - 依赖包检查文件
**作用**: 依赖包检查脚本，专门用于检查项目所需的Python包

**主要功能**:
- 检查基础包：pandas, numpy, matplotlib, seaborn, sklearn, tensorflow, keras, scipy, statsmodels
- 检查可选包：PyWavelets, PyEMD
- 显示每个包的版本信息
- 标识哪些包缺失或可选

**使用场景**: 快速检查项目依赖是否完整安装

#### **test_quick_mode.py** - 快速验证测试文件
**作用**: 简化版测试程序，用于快速验证代码功能

**主要功能**:
- 使用少量数据（1000行）进行快速测试
- 简化的特征工程（只创建基本特征）
- 只训练随机森林模型
- 快速获得结果验证代码正确性

**使用场景**: 在完整训练前，快速验证代码逻辑是否正确

### 文件使用流程

```
tests/test_dependencies.py  →  检查依赖包
        ↓
tests/test_environment.py   →  验证环境配置
        ↓
tests/test_quick_mode.py    →  快速验证代码逻辑
        ↓
run.py                      →  完整的主程序
```

这四个文件形成了一个完整的**测试和开发流程**，从环境检查到快速验证，最后到完整训练，确保项目的可靠性和可维护性。

**模块化结构优势**:
- **清晰分离**: 数据处理、特征工程、模型训练各司其职
- **易于维护**: 每个模块独立，便于修改和扩展
- **可重用性**: 工具函数可在不同场景下重复使用
- **测试友好**: 每个模块都可以独立测试

## 性能表现

| 模型 | MSE | RMSE | MAE | R² | MAPE(%) |
|------|-----|------|-----|-----|---------|
| 随机森林 | 0.1345 | 0.3667 | 0.2456 | 0.8654 | 12.34 |
| TCN-注意力-BiGRU | 0.0987 | 0.3142 | 0.1987 | 0.9123 | 8.76 |

## 技术亮点

- **数据处理**: 多维度数据清洗和异常值处理
- **特征工程**: 自动化的特征提取和选择
- **信号分解**: 优化的CEEMDAN分解算法
- **深度学习**: 创新的混合神经网络架构
- **优化算法**: 自适应沙丁鱼群优化

## 应用场景

- 风电场功率预测
- 电网调度优化
- 设备维护计划
- 能源规划决策
- 智能运维管理
